<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" type="text/css" href="../css/api.css">
    <link rel="stylesheet" type="text/css" href="../css/common.css">
    <link rel="stylesheet" type="text/css" href="../css/common-component.css">
    <link rel="stylesheet" type="text/css" href="../css/font-icon.css">
    <link rel="stylesheet" type="text/css" href="../css/reset.css">
    <link rel="stylesheet" type="text/css" href="../css/caicui.css">
    <script type="text/javascript" src="../script/api.js"></script>
    <script type="text/javascript" src="../script/zepto.js"></script>
  </head>
  <body style="position:relative;width: 100%;height: 100%;overflow: hidden;">
    <iframe width="100%" height="100%"></iframe>

    <script type="text/javascript" src="../script/comm.js"></script>
    <script type="text/javascript" src="../script/doT.min.js"></script>
    <script type="text/javascript" src="../script/caicui.js"></script>
    <script type="text/javascript" src="../script/db.js"></script>
    <script type="text/javascript" src="../script/saveTasksProgress.js"></script>
    <script type="text/javascript"> 
      
      apiready = function () {

          var params = api.pageParam;
          var values;
          if(!isEmpty(params.liveRoomPassword)){
              values = {
                  roomid: params.openCourseLiveRoomId,
                  userid: params.openCourseLiveManageId,
                  viewername: get_loc_val('mine', 'nickName'),
                  viewertoken: params.liveRoomPassword,
                  autoLogin: true
              }

              location.href = 'https://view.csslcloud.net/api/view/login?roomid='+values.roomid+"&userid="+values.userid+"&viewername="+values.viewername+"&viewertoken="+values.viewertoken;

              return false;

          }else{
              values = {
                  roomid: params.openCourseLiveRoomId,
                  userid: params.openCourseLiveManageId,
                  viewername: getstor('memberId'),
                  viewertoken: $api.getStorage('token'),
                  autoLogin: true
              }

          }

          values.roomid = "FD9878C7F1462B8F9C33DC5901307461";
          values.userid = "5A5317CD18F546D7";

          // values.viewername = "8a22cc685215de9f01521b37b748020f";
          // values.viewertoken = "9bb38605-2a65-4c80-bb0e-013d075183ca";
          
           api.showProgress({
               title: '加载中',
               modal: true
           });
          console.log('https://view.csslcloud.net/api/view/login?roomid='+values.roomid+"&userid="+values.userid+"&viewername="+values.viewername+"&viewertoken="+values.viewertoken)
           $("iframe").attr("src",'course-live-iframe.html?roomid='+values.roomid+"&userid="+values.userid+"&viewername="+values.viewername+"&viewertoken="+values.viewertoken)

          api.hideProgress();
    
          
          // $('#viewerSubmit').click();
          
          // api.ajax({
          //     url: 'https://view.csslcloud.net/api/view/login',
          //     method: 'post',
          //     headers: headers,
          //     data: {
          //         values: values
          //     }
          // }, function(ret, err) {
          //     if (ret) {
          //         api.alert({ msg: JSON.stringify(ret) });
          //     } else {
          //         api.alert({ msg: JSON.stringify(err) });
          //     }
          // });
          // location.href = 'https://view.csslcloud.net/api/view/login';
          // location.href = 'https://view.csslcloud.net/api/view/login?roomid=FD9878C7F1462B8F9C33DC5901307461&userid=5A5317CD18F546D7&viewername=8a22ecb55474935701547591f52d044e&viewertoken=f78812b7-46b1-4860-8dbe-077f03cbf482';
        // return;

 
      };

    </script>
  </body>
</html>